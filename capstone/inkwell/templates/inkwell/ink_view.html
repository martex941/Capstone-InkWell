{% extends "inkwell/layout.html" %}

{% block body %}

<script>
    document.addEventListener("DOMContentLoaded", () => {
        following_switch();
    });
</script>

<div class="container-flex inkViewContainer">
    <div class="mt-3 d-flex justify-content-center upperRowInkView">
        <div class="inkViewTitleColumn">
            <h1 class="text-center title">{{ ink.title }}</h1>
            <span class="author-credit text-center">by {{ ink.inkOwner }}</span>
        </div>
    </div>
    <div class="row mt-2 d-flex justify-content-center lowerRowInkView">
        <div class="col-2">
            <div class="chaptersListView">
                <h5 class="text-start">CHAPTERS</h5>
                <ul class="chapter-list">
                    {% for chapter in chapters %}
                        <a href="#anchorChapter{{ chapter.chapterNumber }}"><li>Chapter {{ chapter.chapterNumber }}: {{ chapter.chapterTitle }}</li></a>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="col-7 inkViewContents">
            {% for chapter in chapters %}
            <div id="anchorChapter{{chapter.chapterNumber}}">
                <h5 class="text-center lead chapterTitle">Chapter {{ chapter.chapterNumber}}: {{chapter.chapterTitle}}</h5>
                <p>
                    {{chapter.chapterContents.html|safe}}
                </p>
            </div>
            {% endfor %}
        </div>
        
        <div class="col-2 inkViewComments inkViewButtonsColumn">
            <div class="">
                <a href="{% url 'edit_ink' inkID=ink.id %}"><button class="btn btn-primary">EDIT INK</button></a>
                <div id="dataInkID" data-inkid="{{ink.id}}"></div>
                <div id="following-check" data-following="{{following_check}}"></div>
                <button class="btn btn-primary" id="followBtn" type="submit" onclick="followInk('followInk')">FOLLOW INK</button>
                <button class="btn btn-danger" id="unfollowBtn" type="submit" onclick="followInk('unfollowInk')">UNFOLLOW INK</button>
            </div>
            <h5 class="text-center">COMMENTS</h5>
            <form class="form" action="{% url 'ink_view' inkID=ink.id %}" method="post" name="commentForm">
                {% csrf_token %}
                <h5 class="lead">Write a comment</h5>
                <textarea class="commentContents" rows="4" cols="50" name="commentContents"></textarea>
                <button class="btn btn-primary" type="submit">Comment</button>
            </form>
            
            <div class="comments-section">
                {% for comment in comments %}
                    <div class="comment">
                        <p>{{ comment.content }}</p>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>

</div>

{% endblock%}